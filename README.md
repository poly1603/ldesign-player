# @ldesign/player

> åŠŸèƒ½å¼ºå¤§çš„éŸ³è§†é¢‘æ’­æ”¾å™¨ï¼Œæ”¯æŒä»»æ„æ¡†æ¶ä½¿ç”¨

[![NPM version](https://img.shields.io/npm/v/@ldesign/player.svg)](https://www.npmjs.com/package/@ldesign/player)
[![License](https://img.shields.io/npm/l/@ldesign/player.svg)](https://github.com/ldesign/player/blob/main/LICENSE)

## âœ¨ ç‰¹æ€§

### ğŸµ éŸ³é¢‘æ’­æ”¾å™¨

**P0 æ ¸å¿ƒåŠŸèƒ½ï¼ˆ18é¡¹ï¼‰**
- âœ… å®Œæ•´çš„æ’­æ”¾æ§åˆ¶ï¼ˆæ’­æ”¾/æš‚åœ/åœæ­¢/ä¸Šä¸€æ›²/ä¸‹ä¸€æ›²ï¼‰
- âœ… éŸ³é‡æ§åˆ¶ï¼ˆéŸ³é‡è°ƒèŠ‚/é™éŸ³/æ·¡å…¥æ·¡å‡ºï¼‰
- âœ… è¿›åº¦æ˜¾ç¤ºï¼ˆå¯æ‹–æ‹½è¿›åº¦æ¡/æ—¶é—´æ˜¾ç¤º/ç¼“å†²è¿›åº¦ï¼‰
- âœ… æ’­æ”¾åˆ—è¡¨ç®¡ç†ï¼ˆå¢åˆ æ”¹æŸ¥/æ‹–æ‹½æ’åº/å½“å‰æ’­æ”¾é«˜äº®ï¼‰
- âœ… å¤šç§åŠ è½½æ–¹å¼ï¼ˆæœ¬åœ°æ–‡ä»¶/URL/Blob/Fileï¼‰
- âœ… å¾ªç¯æ¨¡å¼ï¼ˆå•æ›²/åˆ—è¡¨/éšæœº/ä¸å¾ªç¯ï¼‰

**P1 é«˜çº§åŠŸèƒ½ï¼ˆ15é¡¹ï¼‰**
- âœ… æ³¢å½¢å¯è§†åŒ–ï¼ˆCanvas æ¸²æŸ“/å®æ—¶æ³¢å½¢/é¢‘è°±æ˜¾ç¤ºï¼‰
- âœ… æ­Œè¯åŒæ­¥ï¼ˆLRC æ ¼å¼è§£æ/æ»šåŠ¨æ˜¾ç¤º/ç‚¹å‡»è·³è½¬ï¼‰
- âœ… 10é¢‘æ®µå‡è¡¡å™¨ï¼ˆé¢„è®¾éŸ³æ•ˆï¼šæ‘‡æ»š/æµè¡Œ/å¤å…¸ç­‰ï¼‰
- âœ… éŸ³æ•ˆå¤„ç†ï¼ˆæ’­æ”¾é€Ÿåº¦/éŸ³è°ƒè°ƒèŠ‚/AB å¾ªç¯/æ·¡å…¥æ·¡å‡ºï¼‰

### ğŸ¬ è§†é¢‘æ’­æ”¾å™¨

- âœ… å®Œæ•´çš„æ’­æ”¾æ§åˆ¶ï¼ˆæ’­æ”¾/æš‚åœ/åœæ­¢/è·³è½¬ï¼‰
- âœ… éŸ³é‡æ§åˆ¶ï¼ˆéŸ³é‡è°ƒèŠ‚/é™éŸ³ï¼‰
- âœ… å…¨å±æ”¯æŒï¼ˆè¯·æ±‚å…¨å±/é€€å‡ºå…¨å±ï¼‰
- âœ… ç”»ä¸­ç”»æ¨¡å¼ï¼ˆPiPï¼‰
- âœ… å­—å¹•æ”¯æŒï¼ˆSRT/VTT æ ¼å¼ï¼‰
- âœ… å¤šæ¸…æ™°åº¦åˆ‡æ¢
- âœ… è§†é¢‘æˆªå›¾

### ğŸš€ é€šç”¨ç‰¹æ€§

- ğŸ¯ **æ¡†æ¶æ— å…³**: æ”¯æŒ Vue 3ã€React 16.8+ã€åŸç”Ÿ JS
- ğŸ“¦ **ä½“ç§¯å°å·§**: æ ¸å¿ƒåº“ < 50KBï¼ˆgzippedï¼‰
- ğŸ’ª **TypeScript**: å®Œæ•´çš„ç±»å‹å®šä¹‰
- ğŸ¨ **å¯å®šåˆ¶**: æ”¯æŒä¸»é¢˜å®šåˆ¶å’Œæ ·å¼è¦†ç›–
- ğŸ”Œ **æ’ä»¶ç³»ç»Ÿ**: æ˜“äºæ‰©å±•
- ğŸ“± **å“åº”å¼**: ç§»åŠ¨ç«¯å‹å¥½

## ğŸ“¦ å®‰è£…

```bash
npm install @ldesign/player howler
# or
yarn add @ldesign/player howler
# or
pnpm add @ldesign/player howler
```

## ğŸ”¨ ä½¿ç”¨

### åŸç”Ÿ JavaScript

```javascript
import { createAudioPlayer, createVideoPlayer } from '@ldesign/player';
import '@ldesign/player/style.css';

// éŸ³é¢‘æ’­æ”¾å™¨
const audioPlayer = createAudioPlayer({
  playlist: [
    { id: '1', title: 'æ­Œæ›²1', src: 'audio1.mp3' },
    { id: '2', title: 'æ­Œæ›²2', src: 'audio2.mp3' },
  ],
  volume: 0.8,
  loopMode: 'list',
});

audioPlayer.play();

// è§†é¢‘æ’­æ”¾å™¨
const videoPlayer = createVideoPlayer('#video-container', {
  src: 'video.mp4',
  poster: 'poster.jpg',
  controls: true,
});

videoPlayer.play();
```

### Vue 3

```vue
<template>
  <div>
    <h2>éŸ³é¢‘æ’­æ”¾å™¨</h2>
    <button @click="toggle">{{ isPlaying ? 'æš‚åœ' : 'æ’­æ”¾' }}</button>
    <div>{{ formatTime(currentTime) }} / {{ formatTime(duration) }}</div>
    <input 
      type="range" 
      :value="(currentTime / duration) * 100"
      @input="seek($event.target.value)"
    >
    
    <h2>è§†é¢‘æ’­æ”¾å™¨</h2>
    <div ref="videoContainer"></div>
    <button @click="videoToggle">{{ videoIsPlaying ? 'æš‚åœ' : 'æ’­æ”¾' }}</button>
    <button @click="toggleFullscreen">å…¨å±</button>
  </div>
</template>

<script setup>
import { ref } from 'vue';
import { useAudioPlayer, useVideoPlayer } from '@ldesign/player/vue';
import '@ldesign/player/style.css';

// éŸ³é¢‘æ’­æ”¾å™¨
const {
  isPlaying,
  currentTime,
  duration,
  toggle,
  seek: seekAudio,
} = useAudioPlayer({
  playlist: [
    { id: '1', title: 'æ­Œæ›²1', src: 'audio1.mp3' },
  ],
});

// è§†é¢‘æ’­æ”¾å™¨
const videoContainer = ref(null);
const {
  isPlaying: videoIsPlaying,
  toggle: videoToggle,
  toggleFullscreen,
} = useVideoPlayer(videoContainer, {
  src: 'video.mp4',
});

const formatTime = (sec) => {
  const min = Math.floor(sec / 60);
  const s = Math.floor(sec % 60);
  return `${min}:${s.toString().padStart(2, '0')}`;
};

const seek = (value) => {
  seekAudio((value / 100) * duration.value);
};
</script>
```

### React

```jsx
import { useRef } from 'react';
import { useAudioPlayer, useVideoPlayer } from '@ldesign/player/react';
import '@ldesign/player/style.css';

function App() {
  // éŸ³é¢‘æ’­æ”¾å™¨
  const {
    isPlaying,
    currentTime,
    duration,
    toggle,
    seek,
  } = useAudioPlayer({
    playlist: [
      { id: '1', title: 'æ­Œæ›²1', src: 'audio1.mp3' },
    ],
  });

  // è§†é¢‘æ’­æ”¾å™¨
  const videoContainerRef = useRef(null);
  const {
    isPlaying: videoIsPlaying,
    toggle: videoToggle,
    toggleFullscreen,
  } = useVideoPlayer(videoContainerRef, {
    src: 'video.mp4',
  });

  return (
    <div>
      <h2>éŸ³é¢‘æ’­æ”¾å™¨</h2>
      <button onClick={toggle}>
        {isPlaying ? 'æš‚åœ' : 'æ’­æ”¾'}
      </button>
      <div>{currentTime.toFixed(2)} / {duration.toFixed(2)}</div>
      
      <h2>è§†é¢‘æ’­æ”¾å™¨</h2>
      <div ref={videoContainerRef}></div>
      <button onClick={videoToggle}>
        {videoIsPlaying ? 'æš‚åœ' : 'æ’­æ”¾'}
      </button>
      <button onClick={toggleFullscreen}>å…¨å±</button>
    </div>
  );
}
```

## ğŸ“š é«˜çº§åŠŸèƒ½

### æ³¢å½¢å¯è§†åŒ–

```javascript
import { AudioPlayer, WaveformRenderer } from '@ldesign/player';

const player = new AudioPlayer({ enableWebAudio: true });
const canvas = document.getElementById('waveform');
const audioContext = player.getAudioContext();

const waveform = new WaveformRenderer(canvas, audioContext, {
  waveColor: '#1890ff',
  progressColor: '#096dd9',
});

// ç»˜åˆ¶å®æ—¶æ³¢å½¢
waveform.drawRealtimeWaveform();

// è¿æ¥éŸ³é¢‘æº
const howl = player.getHowl();
if (howl) {
  const source = audioContext.createMediaElementSource(howl._sounds[0]._node);
  waveform.connectSource(source);
}
```

### æ­Œè¯åŒæ­¥

```javascript
import { AudioPlayer, LyricsParser } from '@ldesign/player';

const player = new AudioPlayer();
const lyricsParser = new LyricsParser();

// è§£æ LRC æ­Œè¯
await lyricsParser.loadFromUrl('lyrics.lrc');

// ç›‘å¬æ—¶é—´æ›´æ–°ï¼Œè·å–å½“å‰æ­Œè¯
player.on('timeupdate', ({ currentTime }) => {
  const currentLine = lyricsParser.getCurrentLine(currentTime);
  if (currentLine) {
    console.log(currentLine.text);
  }
});
```

### å‡è¡¡å™¨

```javascript
import { AudioPlayer, Equalizer } from '@ldesign/player';

const player = new AudioPlayer({ enableWebAudio: true });
const audioContext = player.getAudioContext();
const equalizer = new Equalizer(audioContext);

// åº”ç”¨é¢„è®¾
equalizer.applyPreset('rock'); // rock, pop, jazz, classical, etc.

// è‡ªå®šä¹‰é¢‘æ®µ
equalizer.setBandGain(0, 5); // 32Hz +5dB
equalizer.setBandGain(1, 3); // 64Hz +3dB
```

## ğŸ¨ ä¸»é¢˜å®šåˆ¶

```css
:root {
  --player-primary-color: #1890ff;
  --player-bg-color: #fff;
  --player-text-color: #000000d9;
  --player-border-radius: 4px;
}

/* æš—è‰²ä¸»é¢˜ */
.ldesign-player.dark {
  --player-bg-color: #141414;
  --player-text-color: #ffffffd9;
}
```

## ğŸ“– API æ–‡æ¡£

è¯¦ç»† API æ–‡æ¡£è¯·å‚è€ƒ [API.md](./API.md)

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ“„ è®¸å¯è¯

MIT License Â© LDesign Team






